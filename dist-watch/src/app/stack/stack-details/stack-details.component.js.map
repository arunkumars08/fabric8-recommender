{"version":3,"file":"stack-details.component.js","sourceRoot":"","sources":["../../../../../src/app/stack/stack-details/stack-details.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, Input, OnChanges, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {Observable} from 'rxjs/Observable';\n\nimport {StackAnalysesService} from '../stack-analyses.service';\nimport {getStackReportModel} from '../utils/stack-api-utils';\nimport {StackReportModel, ResultInformationModel, UserStackInfoModel, ComponentInformationModel, RecommendationsModel} from '../models/stack-report.model';\n\n@Component({\n    selector: 'stack-details',\n    templateUrl: './stack-details.component.html',\n    providers: [StackAnalysesService],\n    encapsulation: ViewEncapsulation.None,\n    styleUrls: ['./stack-details.component.scss'],\n})\n\nexport class StackDetailsComponent implements OnChanges {\n    @Input() stack: string;\n    @Input() displayName;\n    @Input() repoInfo;\n    @Input() buildNumber;\n    @Input() appName;\n\n    @ViewChild('stackModule') modalStackModule: any;\n\n    public error: any = {};\n    public userStackInformation: UserStackInfoModel;\n    public componentLevelInformation: any = {};\n    public userComponentInformation: Array<ComponentInformationModel> = [];\n    public companionLevelRecommendation: any = {};\n    public dataLoaded: boolean = false;\n    public recommendationsArray: Array<RecommendationsModel> = [];\n    public stackLevelOutliers: any = {};\n\n    public companionLevel: any = {};\n    public componentLevel: any = {};\n\n    public componentFilterBy: string = '';\n\n\n    public feedbackConfig: any = {};\n\n    public tabs: Array<any> = [];\n\n    private userStackInformationArray: Array<UserStackInfoModel> = [];\n    private totalManifests: number;\n\n    private stackId: string;\n\n    public tabSelection(tab: any): void {\n        tab['active'] = true;\n        let currentIndex: number = tab['index'];\n        let recommendations: RecommendationsModel = this.recommendationsArray[currentIndex];\n        debugger;\n        this.stackLevelOutliers = {\n            'usage': recommendations.usage_outliers\n        };\n        this.componentLevelInformation = {\n            recommendations: recommendations,\n            dependencies: tab.content.user_stack_info.dependencies,\n            manifestinfo: tab.content.manifest_name\n        };\n        this.companionLevelRecommendation = {\n            dependencies: recommendations.companion\n        };\n    }\n\n    ngOnChanges(): void {\n        this.resetFields();\n        this.stackId = this.stack && this.stack.split('/')[this.stack.split('/').length - 1];\n        // this.init(this.stack);\n        this.initFeedback();\n        this.componentLevel = {\n            header: 'Analysis of your application stack',\n            subHeader: 'Recommended alternative dependencies'\n        };\n        this.companionLevel = {\n            header: 'Possible companion dependencies',\n            subHeader: 'Consider theses additional dependencies'\n        };\n        this.modalStackModule.open();\n        this.displayName = this.displayName || 'Stack Reports';\n    }\n\n    public handleChangeFilter(filterBy: any): void {\n        this.componentFilterBy = filterBy.filterBy;\n    }\n\n    constructor(private stackAnalysisService: StackAnalysesService) {}\n\n    private handleError(error: any): void {\n        this.error = error;\n    }\n\n    private initFeedback(): void {\n        this.feedbackConfig = {\n            name: 'Feedback',\n            stackId: this.stackId,\n            title: 'Tell us your experience',\n            poll: [{\n                question: 'How useful do you find this?',\n                type: 'rating'\n            }, {\n                question: 'How likely do you recommend this to others?',\n                type: 'rating'\n            }, {\n                question: 'Tell us more',\n                type: 'text'\n            }]\n        };\n    }\n\n    private resetFields(): void {\n        this.tabs = [];\n        this.recommendationsArray = [];\n        // this.dataLoaded = false;\n    }\n\n    private init(url: string): void {\n        this.stackAnalysisService\n            .getStackAnalyses(url)\n            .subscribe((data) => {\n                this.error = null;\n                if (data && (!data.hasOwnProperty('error') && Object.keys(data).length !== 0)) {\n                    let resultInformation: Observable<StackReportModel> = getStackReportModel(data);\n                    resultInformation.subscribe((response) => {\n                        console.log(response);\n                        debugger;\n                        let result: Array<ResultInformationModel> = response.result;\n                        this.totalManifests = result.length;\n                        this.userStackInformationArray = result.map((r) => r.user_stack_info);\n                        result.forEach((r, index) => {\n                            console.log('HEre');\n                            this.tabs.push({\n                                title: r.manifest_file_path,\n                                content: r,\n                                index: index\n                            });\n                            this.recommendationsArray.push(r.recommendations); //Change if the API key changes\n                        });\n\n                        this.dataLoaded = true;\n                        this.tabSelection(this.tabs[0]);\n                    });\n                } else {\n                    this.handleError({\n                        message: data.error,\n                        code: data.statusCode,\n                        title: 'Please, wait a while more'\n                    });\n                }\n            },\n            error => {\n                // this.handleError(error);\n                console.log(error);\n                let title: string = '';\n                if (error.status >= 500) {\n                    title = 'Something unexpected happened';\n                } else if (error.status === 404) {\n                    title = 'You are looking for something which isn\\'t there';\n                } else if (error.status === 401) {\n                    title = 'You don\\'t seem to have sufficient privileges to access this';\n                }\n                this.handleError({\n                    message: error.statusText,\n                    code: error.status,\n                    title: title\n                });\n                console.log(this.error);\n            });\n    }\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}